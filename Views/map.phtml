<?php require ("Views/template/header.phtml"); ?>

    <div class="row">
        <div class="col-12">
            <p id="coordinates">Getting your location...</p>
            <div id="map" style="width: 100%; height: 500px; border: 2px solid red;"></div>
        </div>
    </div>

    <script type="text/javascript">
        console.log("Script starting...");
        console.log("Leaflet available?", typeof L !== 'undefined');

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                const lat = position.coords.latitude;
                const lng = position.coords.longitude;
                document.getElementById('coordinates').textContent =
                    `${lat.toFixed(6)}°, ${lng.toFixed(6)}°`;

                console.log("Creating map...");

                // Initialize map
                const map = L.map('map').setView([lat, lng], 15);

                console.log("Map created, adding tiles...");

                // Add OpenStreetMap tile layer
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '© OpenStreetMap contributors'
                }).addTo(map);

                // Add marker
                const marker = L.marker([lat, lng]).addTo(map)
                    .bindPopup("Your Current Location").openPopup();
            });
        }
    </script>

<?php require ("Views/template/footer.phtml"); ?>